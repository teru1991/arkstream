groups:
  - name: profinaut-alerts
    rules:

      # ğŸš¨ Vault ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæœ‰åŠ¹æœŸé™ï¼ˆ24æ™‚é–“ä»¥å†…ï¼‰
      - alert: VaultSecretExpiry
        expr: vault_secret_expiry_seconds < 86400
        for: 1m
        labels:
          severity: critical
          job: vault
        annotations:
          summary: "Vault secret expiring soon"
          description: "Vault secret will expire within 24 hours on {{ $labels.instance }}."

      # âš ï¸ Vault ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®æ›´æ–°ãŒ24æ™‚é–“ä»¥ä¸Šè¡Œã‚ã‚Œã¦ã„ãªã„
      - alert: VaultSecretUpdateStale
        expr: time() - vault_last_secret_update_timestamp_seconds > 86400
        for: 5m
        labels:
          severity: warning
          job: vault
        annotations:
          summary: "Vault secret update stale"
          description: "No Vault secret has been updated in the last 24 hours on {{ $labels.instance }}."

      # ğŸš¨ ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ä¸è¶³ï¼ˆ10%æœªæº€ï¼‰
      - alert: SystemDiskLow
        expr: node_filesystem_free_bytes / node_filesystem_size_bytes < 0.10
        for: 5m
        labels:
          severity: warning
          job: system_monitor
        annotations:
          summary: "Disk usage over 90%"
          description: "Free disk space below 10% on {{ $labels.instance }} ({{ $value | humanizePercentage }})."

      # ğŸ”´ Kafkaãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼åœæ­¢
      - alert: KafkaBrokerDown
        expr: up{job="kafka"} == 0
        for: 1m
        labels:
          severity: critical
          job: kafka
        annotations:
          summary: "Kafka broker down"
          description: "Kafka broker {{ $labels.instance }} is unreachable."

      # âš ï¸ Kafkaãƒ©ã‚°ãŒ1000è¶…
      - alert: KafkaConsumerLagHigh
        expr: kafka_consumergroup_lag > 1000
        for: 2m
        labels:
          severity: warning
          job: kafka
        annotations:
          summary: "High Kafka consumer lag"
          description: "Consumer group {{ $labels.consumergroup }} has lag of {{ $value }} messages."

      # ğŸ”´ MongoDB ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãƒ€ã‚¦ãƒ³
      - alert: MongoDBDown
        expr: up{job="mongodb"} == 0
        for: 1m
        labels:
          severity: critical
          job: mongodb
        annotations:
          summary: "MongoDB down"
          description: "MongoDB instance {{ $labels.instance }} is not responding."

      # âš ï¸ Botã‹ã‚‰ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒ5åˆ†ä»¥ä¸Šæ¥ã¦ã„ãªã„
      - alert: BotMetricsMissing
        expr: time() - bot_last_metric_timestamp_seconds > 300
        for: 2m
        labels:
          severity: warning
          job: bot
        annotations:
          summary: "Bot metrics missing"
          description: "No metrics received from Bot {{ $labels.bot_name }} for over 5 minutes."

      # ğŸ”´ ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼ãŒ5åˆ†é–“ã«5ä»¶ä»¥ä¸Šç™ºç”Ÿ
      - alert: TradeErrorSpike
        expr: increase(trade_error_count[5m]) > 5
        for: 1m
        labels:
          severity: critical
          job: trade
        annotations:
          summary: "Trade error spike"
          description: "More than 5 trade errors occurred in the last 5 minutes for {{ $labels.bot_name }}."

